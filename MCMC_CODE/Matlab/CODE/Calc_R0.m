function R0 = Calc_R0(Pars)

% Contact Matrix: AllContacts
chch=Pars.AllContacts(1,1);
chad=Pars.AllContacts(1,2);
chel=Pars.AllContacts(1,3);
adch=Pars.AllContacts(2,1);
adad=Pars.AllContacts(2,2);
adel=Pars.AllContacts(2,3);
elch=Pars.AllContacts(3,1);
elad=Pars.AllContacts(2,2);
elel=Pars.AllContacts(3,3);

% These don't factor in the end, but are included for completeness
Hch=Pars.hosp_frac(1);
Had=Pars.hosp_frac(2);
Hel=Pars.hosp_frac(3);

Cch=Pars.hosp_crit(1);
Cad=Pars.hosp_crit(2);
Cel=Pars.hosp_crit(3);

F2=[0,Pars.q*chch,Pars.q*chch*Pars.asymp_red,0,0,Pars.q*chad*Pars.asymp_red,Pars.q*chad,Pars.q*chad*Pars.asymp_red,0,0,0,Pars.q*chel,Pars.q*chel*Pars.asymp_red,0,0; ...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ...
   0,Pars.q*adch,Pars.q*adch*Pars.asymp_red,0,0,0,Pars.q*adad,Pars.q*adad*Pars.asymp_red,0,0,0,Pars.q*adel,Pars.q*adel*Pars.asymp_red,0,0; ...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ...
   0,Pars.q*elch,Pars.q*elch*Pars.asymp_red,0,0,0,Pars.q*elad,Pars.q*elad*Pars.asymp_red,0,0,0,Pars.q*elel,Pars.q*elel*Pars.asymp_red,0,0; ...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];

V=[Pars.gamma_e,0,0,0,0,0,0,0,0,0,0,0,0,0,0; ...
   -Pars.gamma_e*Pars.p_symptomatic,Pars.gamma_s,0,0,0,0,0,0,0,0,0,0,0,0,0; ...
   -Pars.gamma_e*(1-Pars.p_symptomatic),0,Pars.gamma_a,0,0,0,0,0,0,0,0,0,0,0,0; ...
   0,-Pars.gamma_s*(Hch-Cch),0,Pars.gamma_hs,0,0,0,0,0,0,0,0,0,0,0; ...
   0,-Pars.gamma_s*Cch,0,0,Pars.gamma_hc,0,0,0,0,0,0,0,0,0,0; ...
   0,0,0,0,0,Pars.gamma_e,0,0,0,0,0,0,0,0,0; ...
   0,0,0,0,0,-Pars.gamma_e*Pars.p_symptomatic,Pars.gamma_s,0,0,0,0,0,0,0,0; ...
   0,0,0,0,0,-Pars.gamma_e*(1-Pars.p_symptomatic),0,Pars.gamma_a,0,0,0,0,0,0,0; ...
   0,0,0,0,0,0,-Pars.gamma_s*(Had-Cad),0,Pars.gamma_hs,0,0,0,0,0,0; ...
   0,0,0,0,0,0,-Pars.gamma_s*Cad,0,0,Pars.gamma_hc,0,0,0,0,0; ...
   0,0,0,0,0,0,0,0,0,0,Pars.gamma_e,0,0,0,0; ...
   0,0,0,0,0,0,0,0,0,0,-Pars.gamma_e*Pars.p_symptomatic,Pars.gamma_s,0,0,0; ...
   0,0,0,0,0,0,0,0,0,0,-Pars.gamma_e*(1-Pars.p_symptomatic),0,Pars.gamma_a,0,0; ...
   0,0,0,0,0,0,0,0,0,0,0,-Pars.gamma_s*(Hel-Cel),0,Pars.gamma_hs,0; ...
   0,0,0,0,0,0,0,0,0,0,0,-Pars.gamma_s*Cel,0,0,Pars.gamma_hc];

U=inv(V);
K=F2*U;

R0 = max(eig(K));
end
