facet_grid(variable~region, scales = 'free_y')
# plot
ggplot(melt.pars, aes(x = region, y = value, fill = date)) +
geom_bar(stat = 'identity', color = 'black', position = 'dodge') +
facet_grid(variable~region, scales = 'free')
# plot
ggplot(melt.pars, aes(x = region, y = value, fill = date)) +
geom_bar(stat = 'identity', color = 'black', position = 'dodge') +
facet_wrap("variable", scales = 'free_y')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/plot_comparisons.R')
df.dirs
temp.res
df.pars
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/plot_comparisons.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/plot_comparisons.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/plot_comparisons.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/plot_comparisons.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/plot_comparisons.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/plot_comparisons.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/plot_comparisons.R')
# plot
ggplot(melt.pars, aes(x = region, y = value, fill = date)) +
geom_bar(stat = 'identity', color = 'black', position = 'dodge') +
facet_wrap("variable", scales = 'free_y')
# plot
ggplot(melt.pars, aes(x = region, y = value, fill = date)) +
geom_bar(stat = 'identity', color = 'black', position = 'dodge') +
facet_wrap("variable", scales = 'free_y') +
scale_fill_brewer(palette = 'Paired')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/plot_comparisons.R')
read.csv('OUTPUT/2020-10-14_inital_conds.csv')
df.in = read.csv('OUTPUT/2020-10-14_inital_conds.csv')[1:3,]
test
df.in
df.in = read.csv('OUTPUT/2020-10-07_targetInits.csv')[1:3,]
df.in
df.in = read.csv('OUTPUT/2020-10-07_targetInits.csv')[1:3,]
df.in
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
df.in
df.in[7:21,1]
df.in[1,7:21]
matrix(df.in[1,7:21], nrow=3)
matrix(df.in[1,7:21], nrow=3, byrow = T)
matrix(df.in[1,7:21], ncol=3)
matrix(df.in[1,2:21], ncol=3)
matrix(df.in[1,2:21], ncol=4)
matrix(df.in[1,2:21], nrow=5)
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
Rescale_target(X0_target = df.in[1,-1])
Rescale_target()
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
test = 1:5
test = 1:6
matrix(test, 2)
test = matrix(test, 2)
colnames(test) = c('a', 'b', 'c')
rownames(test) = c('d', 'e')
test
test{'d'}
test['d']
test['d',]
test[,'e']
test[,'c']
df.in
df.in[,1]
df.in[,2]
df.in[,2]+1
df.in[1,-1
]
df.in[1,-1]
as.vector(df.in[1,-1])
unlist(df.in[1,-1])
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
Rescale_target(-1)
rowSums(Rescale_target(-1))
rowSums(Rescale_target(1))
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
rowSums(Rescale_target(-1))
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
rowSums(Rescale_target(-1))
rowSums(Rescale_target(-))
rowSums(Rescale_target(0))
rowSums(Rescale_target(1))
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
sapply(1:3, function(x){
Rescale_target(0.03, df.in[x,-1])
})
sapply(1:3, function(x){
Rescale_target(0, df.in[x,-1])
})
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
sapply(1:3, function(x){
sapply(c(-1, 0, 0.1, 1), function(y){
Rescale_target(y, df.in[x,-1])
})
})
return(c('init_cond' = y, Rescale_target(y, df.in[x,-1])))
sapply(1:3, function(x){
sapply(c(-1, 0, 0.1, 1), function(y){
return(c('init_cond' = y, Rescale_target(y, df.in[x,-1])))
})
})
sapply(1:3, function(x){
sapply(c(-1, 0, 0.1, 1), function(y){
return(list('init_cond' = y, Rescale_target(y, df.in[x,-1])))
})
})
#sapply(1:3, function(x){
x=1
sapply(c(-1, 0, 0.1, 1), function(y){
return(list('init_cond' = y, Rescale_target(y, df.in[x,-1])))
})
return(list(c('init_cond' = y, Rescale_target(y, df.in[x,-1]))))
sapply(c(-1, 0, 0.1, 1), function(y){
return(list(c('init_cond' = y, Rescale_target(y, df.in[x,-1]))))
})
do.call('rbind', sapply(c(-1, 0, 0.1, 1), function(y){
return(list(c('init_cond' = y, Rescale_target(y, df.in[x,-1]))))
}))
sapply(1:3, function(x){
do.call('rbind', sapply(c(-1, 0, 0.1, 1), function(y){
return(list(c('init_cond' = y, Rescale_target(y, df.in[x,-1]))))
}))
})
do.call('rbind', sapply(c(-1, 0, 0.1, 1), function(y){
return(list(c('init_cond' = y, Rescale_target(y, df.in[x,-1]))))
}))
sapply(1:3, function(x){
res = do.call('rbind', sapply(c(-1, 0, 0.1, 1), function(y){
return(list(c('init_cond' = y, Rescale_target(y, df.in[x,-1]))))
}))
return(list(res))
})
sapply(1:3, function(x){
res = do.call('rbind', sapply(c(-1, 0, 0.1, 1), function(y){
return(list(c('init_cond' = y, Rescale_target(y, df.in[x,-1]))))
}))
res$region = df.in$region[x]
return(list(res))
})
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
sapply(1:3, function(x){
res = do.call('rbind', sapply(c(-1, 0, 0.1, 1), function(y){
return(list(c('init_cond' = y, Rescale_target(y, df.in[x,-1]))))
}))
res = as.data.frame(res)
res$region = df.in$region[x]
return(list(res))
})
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
temp.res
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
temp.res
colnames(temp.res)[1:40] = colnames(df.in)[-1]
temp.res
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
melt.res = melt(temp.res, c('init_cond', 'region'))
head(melt.res)
melt.res = melt(temp.res, c('init_cond', 'region'))
ggplot(melt.res, aes(x = variable, y = value, fill = init_cond)) + geom_bar(stat = 'identity', color = 'black') + facet_wrap('region')
ggplot(melt.res, aes(x = variable, y = value, fill = init_cond)) + geom_bar(stat = 'identity', color = 'black') + facet_grid(region~variable)
ggplot(melt.res, aes(x = variable, y = value, fill = init_cond)) + geom_bar(stat = 'identity', color = 'black') + facet_grid(region~variable, scales = 'free')
ggplot(melt.res, aes(x = variable, y = value, fill = init_cond)) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_grid(region~variable, scales = 'free')
ggplot(melt.res, aes(x = variable, y = value, fill = init_cond)) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap(variable, scales = 'free')
ggplot(melt.res, aes(x = variable, y = value, fill = init_cond)) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap('variable', scales = 'free')
melt.res = melt(temp.res[1:20], c('init_cond', 'region'))
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
melt.res = melt(temp.res[1:20], c('init_cond', 'region'))
ggplot(melt.res, aes(x = variable, y = value, fill = init_cond)) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap('variable', scales = 'free')
ggplot(melt.res, aes(x = variable, y = value, fill = factor(init_cond))) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap('variable', scales = 'free')
ggplot(melt.res[melt.res$region == 'nyc'], aes(x = variable, y = value, fill = factor(init_cond))) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap('variable', scales = 'free')
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap('variable', scales = 'free')
temp.res
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap('variable', scales = 'free')
temp.res
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
temp.res
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
melt.res = melt(temp.res[,-c(21:40)], c('init_cond', 'region'))
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap('variable', scales = 'free')
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap('variable', scales = 'free_x')
rm(list=ls())
require(reshape2)
require(ggplot2)
df.in = read.csv('OUTPUT/2020-10-07_targetInits.csv')[1:3,]
Rescale_target = function(init_cond=0.03, X0_target=df.in[1,-1]){
mat.inits = matrix(unlist(X0_target), nrow=5)
rownames(mat.inits) = c('c', 'a', 'rc', 'fc', 'e')
colnames(mat.inits) = c('S', 'E', 'Isym', 'Iasym', 'Hsub', 'Hcri', 'D', 'R')
mat.inits_rescaled = mat.inits
mat.inits_rescaled[,"S"] = mat.inits[,"S"] - init_cond*rowSums(mat.inits[,c("E", "Isym", "Iasym")])
mat.inits_rescaled[,c("E", "Isym", "Iasym")] = (1+init_cond)*mat.inits[,c("E", "Isym", "Iasym")]
#print(mat.inits)
#print(mat.inits_rescaled)
return(mat.inits_rescaled)
}
Rescale_target()
temp.res = do.call('rbind', sapply(1:3, function(x){
res = do.call('rbind', sapply(c(0, 0.5), function(y){
return(list(c(Rescale_target(y, df.in[x,-1]),'init_cond' = y)))
}))
res = as.data.frame(res)
temp.res = res
for(i in 1:4){
res[i,1:40] = temp.res[i,1:40] - temp.res[2, 1:40]
}
res$region = df.in$region[x]
return(list(res))
}))
colnames(temp.res)[1:40] = colnames(df.in)[-1]
melt.res = melt(temp.res[,-c(21:40)], c('init_cond', 'region'))
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap('variable', scales = 'free_x')
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap('variable', scales = 'free_x')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap('variable', scales = 'free_x')
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap('variable', scales = 'free')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap('variable', scales = 'free')
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) + geom_bar(stat = 'identity', color = 'black', position='dodge') + facet_wrap('variable', scales = 'free', ncol=5)
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) +
geom_bar(stat = 'identity', color = 'black', position='dodge') +
geom_bar(stat = 'identity', color = 'black', position='dodge') +
facet_wrap('variable', scales = 'free', ncol=5)
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) +
geom_bar(color = 'black', position='dodge') +
geom_bar(color = 'grey', position='dodge') +
facet_wrap('variable', scales = 'free', ncol=5)
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) +
geom_bar(color = 'black', position='dodge') +
geom_bar(color = 'grey', position='dodge') +
facet_wrap('variable', scales = 'free', ncol=5)
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) +
geom_bar(stat = 'identity', color = 'black') +
geom_bar(stat = 'identity', color = 'black') +
facet_wrap('variable', scales = 'free', ncol=5)
, position='dodge'
ggplot(melt.res[melt.res$region == 'nyc',], aes(x = variable, y = value, fill = factor(init_cond))) +
geom_bar(stat = 'identity', color = 'black', position='dodge') +
facet_wrap('variable', scales = 'free', ncol=5)
temp.res
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
temp.res
write.csv('adhoc_example_initcond.csv', temp.res)
write.csv('adhoc_example_initcond.csv', temp.res)
write.table('adhoc_example_initcond.csv', temp.res)
write.table('init_examples.csv', temp.res)
write.table(temp.res, 'init_examples.csv')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.25) +
facet_wrap("variable", ncol = 2, scales = 'free')
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4) +
facet_wrap("variable", ncol = 2, scales = 'free')
df.prsf
head(test)
v.chains
strsplit(v.chains[1], '_')
strsplit(v.chains[1], '_')[[1]][2]
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
head(test)
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4) +
facet_grid(variable~region, scales='free')
head(test)
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
head9test)
head(test)
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4) +
facet_grid(variable~region, scales='free')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
head(test)
df.prsf
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
head(test)
paste(colnames(df.prsf, df.prsf['nyc',]))
paste(colnames(df.prsf), df.prsf['nyc',])
paste(colnames(df.prsf), df.prsf['nyc',], sep='=')
paste(colnames(df.prsf), round(df.prsf['nyc',],3), sep='=')
colnames(df.prsf)
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
head(test)
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4, aes()) +
facet_wrap(variable,, ncol=3, scales='free')
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4, aes()) +
facet_wrap(variable, ncol=3, scales='free')
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4, aes()) +
facet_wrap('variable', ncol=3, scales='free')
head(test)
test$variable
table(test$variable)
ls.chains = sapply(v.chains, function(x){
# Read in csv
res = read.csv(paste("OUTPUT/", x, sep='', collapse = ''))
# Data-frame
res = as.data.frame(res)
# Remove last column of NA's since I'm also bad at writing matlab outputs
res = res[,-ncol(res)]
# Add positions
res$idx = 1:(table(res$i_chain)[1])
# add region
res$region = strsplit(x, '_')[[1]][2]
# melt
res = melt(res, c('idx', 'i_chain', 'LogLikelihood', 'region'))
return(res)
v.map = paste(colnames(df.prsf), round(df.prsf['nyc',],3), sep='=')
names(v.map) = colnames(df.prsf)
res$variable = v.map[as.character(res$variable)]
# Return
list(res)
})
test = do.call('rbind', ls.chains)
head(test)
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
head(test)
ls.chains[[1]]$variable
colnames(df.prsf)
levels(ls.chains[[1]]$variable)
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4, aes()) +
facet_wrap('variable', ncol=3, scales='free')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4, aes()) +
facet_wrap('variable', ncol=7, scales='free')
v.chains
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4, aes()) +
facet_wrap('variable', ncol=7, scales='free')
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4, aes()) +
facet_wrap('variable', ncol=3, scales='free')
test[test$region == 'wash' & test$i_chain == 5,] = NULL
test = test[!(test$region == 'wash' & test$i_chain == 5),]
test[test$region == 'wash']
test[test$region == 'wash',]
table(test[test$region == 'wash', 'i_chain'])
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4, aes()) +
facet_wrap('variable', ncol=3, scales='free')
test = test[!(test$region == 'wash' & test$i_chain == 4),]
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4, aes()) +
facet_wrap('variable', ncol=3, scales='free')
df.prsf
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4, aes()) +
facet_wrap('variable', ncol=3, scales='free')
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4, aes()) +
facet_grid(variable~region, scales='free')
ggplot(test[test$variable != 'R0', ], aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4, aes()) +
ylim(c(0,1)) +
facet_grid(variable~region, scales='free')
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.4, aes()) +
facet_grid(variable~region, scales='free')
ggplot(test, aes(x = idx, y = value, color = factor(i_chain))) +
geom_line(alpha = 0.2, aes()) +
facet_grid(variable~region, scales='free')
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
fviz_pca_ind(df.pcs, geom.ind = 'point', habillage = v.hab, addEllipses = T)
fviz_pca_ind(df.pcs, geom.ind = 'point', habillage = v.hab, addEllipses = T)
test = ls.chains[[region]]
head(test)
plotmatrix(iris[,1:3]) + stat_density2d()
require(DescTools)
install.packages('DescTools')
plotmatrix(iris[,1:3]) + stat_density2d()
plotmatrix(iris[,1:3]) + stat_density2d()
require(Desctools)
require(DescTools)
plotmatrix(iris[,1:3]) + stat_density2d()
plotmatrix(iris[,1:3]) + stat_density2d()
PlotMatrix(iris[,1:3]) + stat_density2d()
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
pairs(iris[,1:3])
pairs(iris[,1:3], panel=panel.contour)
install.packages('spatstat')
require(spatstat)
pairs(iris[,1:3], panel=panel.contour)
pairs(test[,1:3], panel=panel.contour)
head(test)
test = ls.chains[[region]]
head(test)
pairs(test[,1:3], panel=panel.contour)
pairs(test[,1:6], panel=panel.contour)
ggplot(test, aes(x = q, y = c)) + geom_density_2d()
ggplot(test, aes(x = q, y = c)) + geom_density_2d_filled()
ggplot(test, aes(x = q, y = c)) + geom_density_2d_filled() + facet_wrap('i_chain')
ggplot(test, aes(x = q, y = c)) + geom_density_2d + facet_wrap('i_chain')
ggplot(test, aes(x = q, y = c)) + geom_density_2d() + facet_wrap('i_chain')
ggplot(test, aes(x = q, y = c)) + geom_point() + facet_wrap('i_chain')
ggplot(test, aes(x = q, y = c)) + geom_density_2d()
install.packages('boom')
install.packages('Boom')
require(Boom)
pairs.density(test[,1:3])
pairs.density(test[,1:3])
PairsDensity(test[,1:3])
PairsDensity(test[,1:3], nlevels = 5)
PairsDensity(test[,1:6], nlevels = 5)
pairs(test[,1:3], nlevels = 5)
test
pairs(test[,1:3], panel=panel.contour)
ggplot(test, aes(x=q, y=c)) + geom_point()
install.packages('ggmcmc')
install.packages('ggally')
install.packages('GGally')
require(GGally)
ggpairs(test[,1:3])
ggpairs(test[,1:3], lower = list(continuous = "density"))
head(test)
ggpairs(test[,1:6], lower = list(continuous = "density"))
test = test[test$i_chain != 4,]
ggpairs(test[,1:6], lower = list(continuous = "density"))
# Contours
region = 'nyc'
test = ls.chains[[region]]
if(region == 'wash'){
test = test[test$i_chain != 4,]
}
ggpairs(test[,1:6], lower = list(continuous = "density"))
region = 'sflor'
test = ls.chains[[region]]
if(region == 'wash'){
test = test[test$i_chain != 4,]
}
ggpairs(test[,1:6], lower = list(continuous = "density"))
# Contours
for(region in c('wash', 'sflor', 'nyc')){
test = ls.chains[[region]]
if(region == 'wash'){
test = test[test$i_chain != 4,]
}
test = test[test$i_chain == 1,]
p_pairs= ggpairs(test[,1:6], lower = list(continuous = "density"))
ggsave(paste(region, '_countour_1.png', sep='', collapse='')
, p_pairs
, 'png'
, width = 12
, height = 12)
}
# Contours
for(region in c('wash', 'sflor', 'nyc')){
for(i in 2:11){
test = ls.chains[[region]]
# if(region == 'wash'){
#   test = test[test$i_chain != 4,]
# }
test = test[test$i_chain == 1,]
p_pairs= ggpairs(test[,1:6], lower = list(continuous = "density"))
ggsave(paste(region, '_countour_', i, '.png', sep='', collapse='')
, p_pairs
, 'png'
, width = 12
, height = 12)
}
}
source('~/CYZ GITHUB/Weitz Group/COVID-19/Lopman Covid SeroPos/Serological_Shielding/CYZ_reorg/Matlab/adhoc_visualize_MCMC_traces.R')
df.prsf
test = df.prsf
melt(test)
test$region = rownames(test)
mest = melt(test, 'region')
ggplot(mest, aes(x = variable, y = value, fill = variable)) + geom_wrap('region') + geom_bar(stat='identity') + scale_fill_brewer(palette = 'Paired')
ggplot(mest, aes(x = variable, y = value, fill = variable)) + facet_wrap('region') + geom_bar(stat='identity') + scale_fill_brewer(palette = 'Paired')
ggplot(mest, aes(x = variable, y = value, color = variable)) + facet_wrap('region') + geom_point() + scale_fill_brewer(palette = 'Paired')
ggplot(mest, aes(x = variable, y = value, color = variable)) + facet_wrap('region') + geom_point() + scale_fill_brewer(palette = 'Paired') + coord_flip()
ggplot(mest, aes(x = variable, y = value, color = variable)) + facet_wrap('region') + geom_point() + scale_fill_brewer(palette = 'Paired')
ggplot(mest, aes(x = variable, y = value)) + facet_wrap('region') + theme_minimal() + geom_point(size=3) + scale_fill_brewer(palette = 'Paired') + geom_hline(yintercept = 1.01, color = 'red')
